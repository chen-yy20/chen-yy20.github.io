<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} - {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    
    <!-- é»‘å¤œæ¨¡å¼åˆå§‹åŒ–è„šæœ¬ -->
    <script>
        // åœ¨é¡µé¢åŠ è½½å‰æ£€æŸ¥å¹¶åº”ç”¨ä¸»é¢˜ï¼Œé¿å…é—ªçƒ
        (function() {
            const theme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    <!-- Google Analytics -->
    {% if site.google_analytics %}
        <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ site.google_analytics }}');
        </script>
    {% endif %}
</head>
<body>
    {% include header.html %}
    
    <main class="main-content">
        {{ content }}
    </main>
    
    {% include footer.html %}

    <!-- é»‘å¤œæ¨¡å¼åˆ‡æ¢è„šæœ¬ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.querySelector('.theme-icon');
            
            // å¦‚æœæŒ‰é’®ä¸å­˜åœ¨å°±é€€å‡ºï¼ˆå¯èƒ½æ˜¯æŸäº›é¡µé¢æ²¡æœ‰headerï¼‰
            if (!themeToggle || !themeIcon) return;
            
            // è·å–å½“å‰ä¸»é¢˜
            function getCurrentTheme() {
                return document.documentElement.getAttribute('data-theme') || 'light';
            }
            
            // æ›´æ–°å›¾æ ‡
            function updateIcon(theme) {
                themeIcon.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
            }
            
            // åˆ‡æ¢ä¸»é¢˜
            function toggleTheme() {
                const currentTheme = getCurrentTheme();
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateIcon(newTheme);
            }
            
            // åˆå§‹åŒ–å›¾æ ‡
            updateIcon(getCurrentTheme());
            
            // ç»‘å®šç‚¹å‡»äº‹ä»¶
            themeToggle.addEventListener('click', toggleTheme);
        });
    </script>
</body>
</html>